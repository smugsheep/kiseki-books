import{s as oe,a as ne,n as X,r as re,c as Y,o as ie,b as Z}from"./scheduler.C7eb8iQI.js";import{S as ce,i as ue,e as p,t as U,s as q,H as de,c as m,a as k,b as K,d as b,f as B,q as he,r as T,g as se,h as c,u as x,v as R,j as ae,w as _e,x as $,y as fe}from"./index.BLCotMXT.js";import{e as ee,l as ve}from"./stores.DEPE9uqq.js";import{p as be}from"./stores.Me_Urmo9.js";import{g as ge,b as pe}from"./entry.iN7cT1YV.js";function te(e,s,t){const u=e.slice();return u[18]=s[t],u}function le(e){let s,t=(e[1].books.length>1?e[2]==="en"?e[18].title:e[18].title_ja:"-")+"",u,f,d;return{c(){s=p("option"),u=U(t),f=q(),this.h()},l(a){s=m(a,"OPTION",{class:!0});var n=k(s);u=K(n,t),f=B(n),n.forEach(b),this.h()},h(){s.__value=d=e[18].part,$(s,s.__value),T(s,"class","svelte-1y7574o")},m(a,n){se(a,s,n),c(s,u),c(s,f)},p(a,n){n&6&&t!==(t=(a[1].books.length>1?a[2]==="en"?a[18].title:a[18].title_ja:"-")+"")&&ae(u,t),n&2&&d!==(d=a[18].part)&&(s.__value=d,$(s,s.__value))},d(a){a&&b(s)}}}function me(e){let s,t,u,f,d,a,n,v,w,I,V,h,E,P,g,O,j,A,y,D,l,H,C,S=ee(e[1].books),i=[];for(let o=0;o<S.length;o+=1)i[o]=le(te(e,S,o));return{c(){s=p("div"),t=p("div"),u=p("div"),f=p("h1"),d=U(e[3]),a=q(),n=p("div"),v=p("button"),w=U("←"),V=q(),h=p("select");for(let o=0;o<i.length;o+=1)i[o].c();P=q(),g=p("button"),O=U("→"),A=q(),y=p("div"),D=p("div"),l=new de(!1),this.h()},l(o){s=m(o,"DIV",{class:!0});var _=k(s);t=m(_,"DIV",{class:!0});var r=k(t);u=m(r,"DIV",{});var N=k(u);f=m(N,"H1",{class:!0});var z=k(f);d=K(z,e[3]),z.forEach(b),N.forEach(b),a=B(r),n=m(r,"DIV",{class:!0});var L=k(n);v=m(L,"BUTTON",{class:!0});var F=k(v);w=K(F,"←"),F.forEach(b),V=B(L),h=m(L,"SELECT",{class:!0});var G=k(h);for(let M=0;M<i.length;M+=1)i[M].l(G);G.forEach(b),P=B(L),g=m(L,"BUTTON",{class:!0});var J=k(g);O=K(J,"→"),J.forEach(b),L.forEach(b),r.forEach(b),A=B(_),y=m(_,"DIV",{id:!0,class:!0});var Q=k(y);D=m(Q,"DIV",{});var W=k(D);l=he(W,!1),W.forEach(b),Q.forEach(b),_.forEach(b),this.h()},h(){T(f,"class","svelte-1y7574o"),v.disabled=I=e[0]<=1,T(v,"class","svelte-1y7574o"),h.disabled=E=e[1].books.length<2,T(h,"class","svelte-1y7574o"),e[0]===void 0&&ne(()=>e[9].call(h)),g.disabled=j=e[0]>=e[1].books.length,T(g,"class","svelte-1y7574o"),T(n,"class","part-picker svelte-1y7574o"),T(t,"class","top svelte-1y7574o"),l.a=null,T(y,"id","viewer"),T(y,"class","svelte-1y7574o"),T(s,"class","viewer-wrapper svelte-1y7574o")},m(o,_){se(o,s,_),c(s,t),c(t,u),c(u,f),c(f,d),c(t,a),c(t,n),c(n,v),c(v,w),c(n,V),c(n,h);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(h,null);x(h,e[0],!0),c(n,P),c(n,g),c(g,O),c(s,A),c(s,y),c(y,D),l.m(e[4],D),e[11](y),e[12](s),H||(C=[R(v,"click",e[8]),R(h,"change",e[9]),R(g,"click",e[10])],H=!0)},p(o,[_]){if(_&8&&ae(d,o[3]),_&3&&I!==(I=o[0]<=1)&&(v.disabled=I),_&6){S=ee(o[1].books);let r;for(r=0;r<S.length;r+=1){const N=te(o,S,r);i[r]?i[r].p(N,_):(i[r]=le(N),i[r].c(),i[r].m(h,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=S.length}_&2&&E!==(E=o[1].books.length<2)&&(h.disabled=E),_&3&&x(h,o[0]),_&3&&j!==(j=o[0]>=o[1].books.length)&&(g.disabled=j),_&16&&l.p(o[4])},i:X,o:X,d(o){o&&b(s),_e(i,o),e[11](null),e[12](null),H=!1,re(C)}}}function ke(e,s,t){let u,f;Y(e,be,l=>t(14,u=l)),Y(e,ve,l=>t(2,f=l));let{selectedSeries:d}=s,{currentPart:a=1}=s,n,v,w,I,V;function h(l,H,C){V&&l.id!==V&&(t(0,a=1),H=1),V=l.id,u.url.pathname.includes(l.slug)&&setTimeout(()=>{ge(`${pe}/${l.slug}/${a}`,!1)},1);let S=l.books.find(i=>i.part==H);if(C==="en"){t(3,n=l.title),t(4,v=S.text_en);return}t(3,n=l.title_ja),t(4,v=S.text_ja)}function E(l){l==="right"&&a<d.books.length?t(0,a++,a):l==="left"&&a>1&&t(0,a--,a)}async function P(){w&&d.id!=9999&&(t(5,w.scrollTop=0,w),I.parentElement.parentElement.scrollIntoView({behavior:"auto",block:"start"}))}function g(l){switch(l.key){case"ArrowRight":E("right");break;case"ArrowLeft":E("left");break}}ie(()=>(P(),window.addEventListener("keydown",g),()=>{window.removeEventListener("keydown",g)}));const O=()=>E("left");function j(){a=fe(this),t(0,a),t(1,d)}const A=()=>E("right");function y(l){Z[l?"unshift":"push"](()=>{w=l,t(5,w)})}function D(l){Z[l?"unshift":"push"](()=>{I=l,t(6,I)})}return e.$$set=l=>{"selectedSeries"in l&&t(1,d=l.selectedSeries),"currentPart"in l&&t(0,a=l.currentPart)},e.$$.update=()=>{e.$$.dirty&1&&P(),e.$$.dirty&7&&h(d,a,f)},[a,d,f,n,v,w,I,E,O,j,A,y,D]}class Se extends ce{constructor(s){super(),ue(this,s,ke,me,oe,{selectedSeries:1,currentPart:0})}}export{Se as V};
