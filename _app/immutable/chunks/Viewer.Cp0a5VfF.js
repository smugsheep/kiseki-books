import{s as ne,a as oe,n as X,r as re,c as Y,o as ie,b as Z}from"./scheduler.C7eb8iQI.js";import{S as ce,i as ue,e as g,t as U,s as q,H as fe,c as p,a as k,b as K,d as b,f as B,q as de,r as I,g as se,h as c,u as x,v as R,j as ae,w as he,x as $,y as _e}from"./index.BLCotMXT.js";import{e as ee,l as ve}from"./stores.CfDhSz14.js";import{p as be}from"./stores.ChZ8_DF9.js";import{g as me,b as ge}from"./entry.DSzQJ76q.js";function te(e,s,t){const u=e.slice();return u[18]=s[t],u}function le(e){let s,t=(e[1].books.length>1?e[2]==="en"?e[18].title:e[18].title_ja:"-")+"",u,_,f;return{c(){s=g("option"),u=U(t),_=q(),this.h()},l(a){s=p(a,"OPTION",{class:!0});var o=k(s);u=K(o,t),_=B(o),o.forEach(b),this.h()},h(){s.__value=f=e[18].part,$(s,s.__value),I(s,"class","svelte-1fac82m")},m(a,o){se(a,s,o),c(s,u),c(s,_)},p(a,o){o&6&&t!==(t=(a[1].books.length>1?a[2]==="en"?a[18].title:a[18].title_ja:"-")+"")&&ae(u,t),o&2&&f!==(f=a[18].part)&&(s.__value=f,$(s,s.__value))},d(a){a&&b(s)}}}function pe(e){let s,t,u,_,f,a,o,v,w,S,D,d,E,j,m,O,y,A,T,P,l,H,C,V=ee(e[1].books),i=[];for(let n=0;n<V.length;n+=1)i[n]=le(te(e,V,n));return{c(){s=g("div"),t=g("div"),u=g("div"),_=g("h1"),f=U(e[3]),a=q(),o=g("div"),v=g("button"),w=U("←"),D=q(),d=g("select");for(let n=0;n<i.length;n+=1)i[n].c();j=q(),m=g("button"),O=U("→"),A=q(),T=g("div"),P=g("div"),l=new fe(!1),this.h()},l(n){s=p(n,"DIV",{class:!0});var h=k(s);t=p(h,"DIV",{class:!0});var r=k(t);u=p(r,"DIV",{});var N=k(u);_=p(N,"H1",{class:!0});var z=k(_);f=K(z,e[3]),z.forEach(b),N.forEach(b),a=B(r),o=p(r,"DIV",{class:!0});var L=k(o);v=p(L,"BUTTON",{class:!0});var F=k(v);w=K(F,"←"),F.forEach(b),D=B(L),d=p(L,"SELECT",{class:!0});var G=k(d);for(let M=0;M<i.length;M+=1)i[M].l(G);G.forEach(b),j=B(L),m=p(L,"BUTTON",{class:!0});var J=k(m);O=K(J,"→"),J.forEach(b),L.forEach(b),r.forEach(b),A=B(h),T=p(h,"DIV",{id:!0,class:!0});var Q=k(T);P=p(Q,"DIV",{});var W=k(P);l=de(W,!1),W.forEach(b),Q.forEach(b),h.forEach(b),this.h()},h(){I(_,"class","svelte-1fac82m"),v.disabled=S=e[0]<=1,I(v,"class","svelte-1fac82m"),d.disabled=E=e[1].books.length<2,I(d,"class","svelte-1fac82m"),e[0]===void 0&&oe(()=>e[9].call(d)),m.disabled=y=e[0]>=e[1].books.length,I(m,"class","svelte-1fac82m"),I(o,"class","part-picker svelte-1fac82m"),I(t,"class","top svelte-1fac82m"),l.a=null,I(T,"id","viewer"),I(T,"class","svelte-1fac82m"),I(s,"class","viewer-wrapper svelte-1fac82m")},m(n,h){se(n,s,h),c(s,t),c(t,u),c(u,_),c(_,f),c(t,a),c(t,o),c(o,v),c(v,w),c(o,D),c(o,d);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(d,null);x(d,e[0],!0),c(o,j),c(o,m),c(m,O),c(s,A),c(s,T),c(T,P),l.m(e[4],P),e[11](T),e[12](s),H||(C=[R(v,"click",e[8]),R(d,"change",e[9]),R(m,"click",e[10])],H=!0)},p(n,[h]){if(h&8&&ae(f,n[3]),h&3&&S!==(S=n[0]<=1)&&(v.disabled=S),h&6){V=ee(n[1].books);let r;for(r=0;r<V.length;r+=1){const N=te(n,V,r);i[r]?i[r].p(N,h):(i[r]=le(N),i[r].c(),i[r].m(d,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=V.length}h&2&&E!==(E=n[1].books.length<2)&&(d.disabled=E),h&3&&x(d,n[0]),h&3&&y!==(y=n[0]>=n[1].books.length)&&(m.disabled=y),h&16&&l.p(n[4])},i:X,o:X,d(n){n&&b(s),he(i,n),e[11](null),e[12](null),H=!1,re(C)}}}function ke(e,s,t){let u,_;Y(e,be,l=>t(14,u=l)),Y(e,ve,l=>t(2,_=l));let{selectedSeries:f}=s,{currentPart:a=1}=s,o,v,w,S,D;function d(l,H,C){D&&l.id!==D&&(t(0,a=1),H=1),D=l.id,u.url.pathname.includes(l.slug)&&setTimeout(()=>{me(`${ge}/${l.slug}/${a}`,!1)},1);let V=l.books.find(i=>i.part==H);if(C==="en"){t(3,o=l.title),t(4,v=V.text_en);return}t(3,o=l.title_ja),t(4,v=V.text_ja)}function E(l){l==="right"&&a<f.books.length?t(0,a++,a):l==="left"&&a>1&&t(0,a--,a)}async function j(){w&&f.id!=9999&&(t(5,w.scrollTop=0,w),S.parentElement.parentElement.scrollIntoView({behavior:"auto",block:"start"}))}function m(l){switch(l.key){case"ArrowRight":E("right");break;case"ArrowLeft":E("left");break}}ie(()=>(j(),window.addEventListener("keydown",m),()=>{window.removeEventListener("keydown",m)}));const O=()=>E("left");function y(){a=_e(this),t(0,a),t(1,f)}const A=()=>E("right");function T(l){Z[l?"unshift":"push"](()=>{w=l,t(5,w)})}function P(l){Z[l?"unshift":"push"](()=>{S=l,t(6,S)})}return e.$$set=l=>{"selectedSeries"in l&&t(1,f=l.selectedSeries),"currentPart"in l&&t(0,a=l.currentPart)},e.$$.update=()=>{e.$$.dirty&1&&j(),e.$$.dirty&7&&d(f,a,_)},[a,f,_,o,v,w,S,E,O,y,A,T,P]}class Ve extends ce{constructor(s){super(),ue(this,s,ke,pe,ne,{selectedSeries:1,currentPart:0})}}export{Ve as V};
